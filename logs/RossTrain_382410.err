/var/spool/slurmd/job382410/slurm_script: line 13: RUN_NAME: command not found
+ conda init
+ conda activate ross

CondaError: Run 'conda init' before 'conda activate'

++ hostname
+ MASTER_ADDR=h001
+ MASTER_PORT=29805
+ torchrun --nproc-per-node=4 --nnodes 1 --node_rank 0 --master_addr=h001 --master_port=29805 train.py --per_device_train_batch_size 4 --gradient_accumulation_steps 8 --learning_rate 2e-5 --warmup_ratio 0.03 --deepspeed ./scripts/zero3.json --model_name_or_path HaochenWang/ross-qwen2-7b --pretrain_mm_mlp_adapter ./checkpoints/ross-siglip-qwen2-7b-pt558k/mm_projector.bin --pretrain_mm_inv_mlp_adapter ./checkpoints/ross-siglip-qwen2-7b-pt558k/mm_inv_projector.bin --output_dir ./checkpoints/ --vision_tower google/siglip-so400m-patch14-384 --version qwen_2 --mm_pixel_decoder ./pretrained_vae --data_path ./train_scenes.jsonl --image_folder '' --mm_projector_type mlp2x_gelu --mm_inv_projector_type denoiser_vit3x --mm_vision_select_layer -2 --mm_use_im_start_end False --mm_use_im_patch_token False --image_aspect_ratio pad --group_by_modality_length True --bf16 True --num_train_epochs 3 --per_device_eval_batch_size 4 --evaluation_strategy no --save_strategy steps --save_on_each_epoch=True --save_steps 50 --save_total_limit 1 --save_only_model --weight_decay 0. --lr_scheduler_type cosine --logging_steps 1 --tf32 True --model_max_length 32768 --gradient_checkpointing True --dataloader_num_workers 4 --lazy_preprocess True --report_to wandb --run_name
[2025-03-01 00:26:33,270] torch.distributed.run: [WARNING] 
[2025-03-01 00:26:33,270] torch.distributed.run: [WARNING] *****************************************
[2025-03-01 00:26:33,270] torch.distributed.run: [WARNING] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
[2025-03-01 00:26:33,270] torch.distributed.run: [WARNING] *****************************************
usage: train.py [-h] [--model_name_or_path MODEL_NAME_OR_PATH]
                [--version VERSION] [--freeze_backbone [FREEZE_BACKBONE]]
                [--tune_mm_mlp_adapter [TUNE_MM_MLP_ADAPTER]]
                [--vision_tower VISION_TOWER]
                [--unfreeze_mm_vision_tower [UNFREEZE_MM_VISION_TOWER]]
                [--mm_pixel_decoder MM_PIXEL_DECODER]
                [--mm_vision_select_layer MM_VISION_SELECT_LAYER]
                [--pretrain_mm_mlp_adapter PRETRAIN_MM_MLP_ADAPTER]
                [--pretrain_mm_inv_mlp_adapter PRETRAIN_MM_INV_MLP_ADAPTER]
                [--mm_projector_type MM_PROJECTOR_TYPE]
                [--mm_inv_projector_type MM_INV_PROJECTOR_TYPE]
                [--mm_use_im_start_end [MM_USE_IM_START_END]]
                [--mm_use_im_patch_token [MM_USE_IM_PATCH_TOKEN]]
                [--no_mm_use_im_patch_token]
                [--mm_patch_merge_type MM_PATCH_MERGE_TYPE]
                [--mm_vision_select_feature MM_VISION_SELECT_FEATURE]
                [--data_path DATA_PATH] [--lazy_preprocess [LAZY_PREPROCESS]]
                [--is_multimodal [IS_MULTIMODAL]]
                [--image_folder IMAGE_FOLDER]
                [--image_aspect_ratio IMAGE_ASPECT_RATIO] --output_dir
                OUTPUT_DIR [--overwrite_output_dir [OVERWRITE_OUTPUT_DIR]]
                [--do_train [DO_TRAIN]] [--do_eval [DO_EVAL]]
                [--do_predict [DO_PREDICT]] [--eval_strategy {no,steps,epoch}]
                [--prediction_loss_only [PREDICTION_LOSS_ONLY]]
                [--per_device_train_batch_size PER_DEVICE_TRAIN_BATCH_SIZE]
                [--per_device_eval_batch_size PER_DEVICE_EVAL_BATCH_SIZE]
                [--per_gpu_train_batch_size PER_GPU_TRAIN_BATCH_SIZE]
                [--per_gpu_eval_batch_size PER_GPU_EVAL_BATCH_SIZE]
                [--gradient_accumulation_steps GRADIENT_ACCUMULATION_STEPS]
                [--eval_accumulation_steps EVAL_ACCUMULATION_STEPS]
                [--eval_delay EVAL_DELAY]
                [--torch_empty_cache_steps TORCH_EMPTY_CACHE_STEPS]
                [--learning_rate LEARNING_RATE] [--weight_decay WEIGHT_DECAY]
                [--adam_beta1 ADAM_BETA1] [--adam_beta2 ADAM_BETA2]
                [--adam_epsilon ADAM_EPSILON] [--max_grad_norm MAX_GRAD_NORM]
                [--num_train_epochs NUM_TRAIN_EPOCHS] [--max_steps MAX_STEPS]
                [--lr_scheduler_type {linear,cosine,cosine_with_restarts,polynomial,constant,constant_with_warmup,inverse_sqrt,reduce_lr_on_plateau,cosine_with_min_lr,warmup_stable_decay}]
                [--lr_scheduler_kwargs LR_SCHEDULER_KWARGS]
                [--warmup_ratio WARMUP_RATIO] [--warmup_steps WARMUP_STEPS]
                [--log_level {detail,debug,info,warning,error,critical,passive}]
                [--log_level_replica {detail,debug,info,warning,error,critical,passive}]
                [--log_on_each_node [LOG_ON_EACH_NODE]]
                [--no_log_on_each_node] [--logging_dir LOGGING_DIR]
                [--logging_strategy {no,steps,epoch}]
                [--logging_first_step [LOGGING_FIRST_STEP]]
                [--logging_steps LOGGING_STEPS]
                [--logging_nan_inf_filter [LOGGING_NAN_INF_FILTER]]
                [--no_logging_nan_inf_filter]
                [--save_strategy {no,steps,epoch}] [--save_steps SAVE_STEPS]
                [--save_total_limit SAVE_TOTAL_LIMIT]
                [--save_safetensors [SAVE_SAFETENSORS]]
                [--no_save_safetensors]
                [--save_on_each_node [SAVE_ON_EACH_NODE]]
                [--save_only_model [SAVE_ONLY_MODEL]]
                [--restore_callback_states_from_checkpoint [RESTORE_CALLBACK_STATES_FROM_CHECKPOINT]]
                [--no_cuda [NO_CUDA]] [--use_cpu [USE_CPU]]
                [--use_mps_device [USE_MPS_DEVICE]] [--seed SEED]
                [--data_seed DATA_SEED] [--jit_mode_eval [JIT_MODE_EVAL]]
                [--use_ipex [USE_IPEX]] [--bf16 [BF16]] [--fp16 [FP16]]
                [--fp16_opt_level FP16_OPT_LEVEL]
                [--half_precision_backend {auto,apex,cpu_amp}]
                [--bf16_full_eval [BF16_FULL_EVAL]]
                [--fp16_full_eval [FP16_FULL_EVAL]] [--tf32 TF32]
                [--local_rank LOCAL_RANK]
                [--ddp_backend {nccl,gloo,mpi,ccl,hccl,cncl}]
                [--tpu_num_cores TPU_NUM_CORES]
                [--tpu_metrics_debug [TPU_METRICS_DEBUG]]
                [--debug DEBUG [DEBUG ...]]
                [--dataloader_drop_last [DATALOADER_DROP_LAST]]
                [--eval_steps EVAL_STEPS]
                [--dataloader_num_workers DATALOADER_NUM_WORKERS]
                [--dataloader_prefetch_factor DATALOADER_PREFETCH_FACTOR]
                [--past_index PAST_INDEX] [--run_name RUN_NAME]
                [--disable_tqdm DISABLE_TQDM]
                [--remove_unused_columns [REMOVE_UNUSED_COLUMNS]]
                [--label_names LABEL_NAMES [LABEL_NAMES ...]]
                [--load_best_model_at_end [LOAD_BEST_MODEL_AT_END]]
                [--metric_for_best_model METRIC_FOR_BEST_MODEL]
                [--greater_is_better GREATER_IS_BETTER]
                [--ignore_data_skip [IGNORE_DATA_SKIP]] [--fsdp FSDP]
                [--fsdp_min_num_params FSDP_MIN_NUM_PARAMS]
                [--fsdp_config FSDP_CONFIG]
                [--fsdp_transformer_layer_cls_to_wrap FSDP_TRANSFORMER_LAYER_CLS_TO_WRAP]
                [--accelerator_config ACCELERATOR_CONFIG]
                [--deepspeed DEEPSPEED]
                [--label_smoothing_factor LABEL_SMOOTHING_FACTOR]
                [--optim OPTIM] [--optim_args OPTIM_ARGS]
                [--adafactor [ADAFACTOR]]
                [--group_by_length [GROUP_BY_LENGTH]]
                [--length_column_name LENGTH_COLUMN_NAME]
                [--report_to REPORT_TO]
                [--ddp_find_unused_parameters DDP_FIND_UNUSED_PARAMETERS]
                [--ddp_bucket_cap_mb DDP_BUCKET_CAP_MB]
                [--ddp_broadcast_buffers DDP_BROADCAST_BUFFERS]
                [--dataloader_pin_memory [DATALOADER_PIN_MEMORY]]
                [--no_dataloader_pin_memory]
                [--dataloader_persistent_workers [DATALOADER_PERSISTENT_WORKERS]]
                [--skip_memory_metrics [SKIP_MEMORY_METRICS]]
                [--no_skip_memory_metrics]
                [--use_legacy_prediction_loop [USE_LEGACY_PREDICTION_LOOP]]
                [--push_to_hub [PUSH_TO_HUB]]
                [--resume_from_checkpoint RESUME_FROM_CHECKPOINT]
                [--hub_model_id HUB_MODEL_ID]
                [--hub_strategy {end,every_save,checkpoint,all_checkpoints}]
                [--hub_token HUB_TOKEN]
                [--hub_private_repo [HUB_PRIVATE_REPO]]
                [--hub_always_push [HUB_ALWAYS_PUSH]]
                [--gradient_checkpointing [GRADIENT_CHECKPOINTING]]
                [--gradient_checkpointing_kwargs GRADIENT_CHECKPOINTING_KWARGS]
                [--include_inputs_for_metrics [INCLUDE_INPUTS_FOR_METRICS]]
                [--eval_do_concat_batches [EVAL_DO_CONCAT_BATCHES]]
                [--no_eval_do_concat_batches]
                [--fp16_backend {auto,apex,cpu_amp}]
                [--evaluation_strategy {no,steps,epoch}]
                [--push_to_hub_model_id PUSH_TO_HUB_MODEL_ID]
                [--push_to_hub_organization PUSH_TO_HUB_ORGANIZATION]
                [--push_to_hub_token PUSH_TO_HUB_TOKEN]
                [--mp_parameters MP_PARAMETERS]
                [--auto_find_batch_size [AUTO_FIND_BATCH_SIZE]]
                [--full_determinism [FULL_DETERMINISM]]
                [--torchdynamo TORCHDYNAMO] [--ray_scope RAY_SCOPE]
                [--ddp_timeout DDP_TIMEOUT] [--torch_compile [TORCH_COMPILE]]
                [--torch_compile_backend TORCH_COMPILE_BACKEND]
                [--torch_compile_mode TORCH_COMPILE_MODE]
                [--dispatch_batches DISPATCH_BATCHES]
                [--split_batches SPLIT_BATCHES]
                [--include_tokens_per_second [INCLUDE_TOKENS_PER_SECOND]]
                [--include_num_input_tokens_seen [INCLUDE_NUM_INPUT_TOKENS_SEEN]]
                [--neftune_noise_alpha NEFTUNE_NOISE_ALPHA]
                [--optim_target_modules OPTIM_TARGET_MODULES]
                [--batch_eval_metrics [BATCH_EVAL_METRICS]]
                [--eval_on_start [EVAL_ON_START]]
                [--eval_use_gather_object [EVAL_USE_GATHER_OBJECT]]
                [--cache_dir CACHE_DIR]
                [--freeze_mm_mlp_adapter [FREEZE_MM_MLP_ADAPTER]]
                [--mpt_attn_impl MPT_ATTN_IMPL]
                [--model_max_length MODEL_MAX_LENGTH]
                [--double_quant [DOUBLE_QUANT]] [--no_double_quant]
                [--quant_type QUANT_TYPE] [--bits BITS]
                [--lora_enable [LORA_ENABLE]] [--lora_r LORA_R]
                [--lora_alpha LORA_ALPHA] [--lora_dropout LORA_DROPOUT]
                [--lora_weight_path LORA_WEIGHT_PATH] [--lora_bias LORA_BIAS]
                [--mm_projector_lr MM_PROJECTOR_LR]
                [--mm_inv_projector_lr MM_INV_PROJECTOR_LR]
                [--mm_vision_tower_lr MM_VISION_TOWER_LR]
                [--group_by_modality_length [GROUP_BY_MODALITY_LENGTH]]
usage: train.py [-h] [--model_name_or_path MODEL_NAME_OR_PATH]
                [--version VERSION] [--freeze_backbone [FREEZE_BACKBONE]]
                [--tune_mm_mlp_adapter [TUNE_MM_MLP_ADAPTER]]
                [--vision_tower VISION_TOWER]
                [--unfreeze_mm_vision_tower [UNFREEZE_MM_VISION_TOWER]]
                [--mm_pixel_decoder MM_PIXEL_DECODER]
                [--mm_vision_select_layer MM_VISION_SELECT_LAYER]
                [--pretrain_mm_mlp_adapter PRETRAIN_MM_MLP_ADAPTER]
                [--pretrain_mm_inv_mlp_adapter PRETRAIN_MM_INV_MLP_ADAPTER]
                [--mm_projector_type MM_PROJECTOR_TYPE]
                [--mm_inv_projector_type MM_INV_PROJECTOR_TYPE]
                [--mm_use_im_start_end [MM_USE_IM_START_END]]
                [--mm_use_im_patch_token [MM_USE_IM_PATCH_TOKEN]]
                [--no_mm_use_im_patch_token]
                [--mm_patch_merge_type MM_PATCH_MERGE_TYPE]
                [--mm_vision_select_feature MM_VISION_SELECT_FEATURE]
                [--data_path DATA_PATH] [--lazy_preprocess [LAZY_PREPROCESS]]
                [--is_multimodal [IS_MULTIMODAL]]
                [--image_folder IMAGE_FOLDER]
                [--image_aspect_ratio IMAGE_ASPECT_RATIO] --output_dir
                OUTPUT_DIR [--overwrite_output_dir [OVERWRITE_OUTPUT_DIR]]
                [--do_train [DO_TRAIN]] [--do_eval [DO_EVAL]]
                [--do_predict [DO_PREDICT]] [--eval_strategy {no,steps,epoch}]
                [--prediction_loss_only [PREDICTION_LOSS_ONLY]]
                [--per_device_train_batch_size PER_DEVICE_TRAIN_BATCH_SIZE]
                [--per_device_eval_batch_size PER_DEVICE_EVAL_BATCH_SIZE]
                [--per_gpu_train_batch_size PER_GPU_TRAIN_BATCH_SIZE]
                [--per_gpu_eval_batch_size PER_GPU_EVAL_BATCH_SIZE]
                [--gradient_accumulation_steps GRADIENT_ACCUMULATION_STEPS]
                [--eval_accumulation_steps EVAL_ACCUMULATION_STEPS]
                [--eval_delay EVAL_DELAY]
                [--torch_empty_cache_steps TORCH_EMPTY_CACHE_STEPS]
                [--learning_rate LEARNING_RATE] [--weight_decay WEIGHT_DECAY]
                [--adam_beta1 ADAM_BETA1] [--adam_beta2 ADAM_BETA2]
                [--adam_epsilon ADAM_EPSILON] [--max_grad_norm MAX_GRAD_NORM]
                [--num_train_epochs NUM_TRAIN_EPOCHS] [--max_steps MAX_STEPS]
                [--lr_scheduler_type {linear,cosine,cosine_with_restarts,polynomial,constant,constant_with_warmup,inverse_sqrt,reduce_lr_on_plateau,cosine_with_min_lr,warmup_stable_decay}]
                [--lr_scheduler_kwargs LR_SCHEDULER_KWARGS]
                [--warmup_ratio WARMUP_RATIO] [--warmup_steps WARMUP_STEPS]
                [--log_level {detail,debug,info,warning,error,critical,passive}]
                [--log_level_replica {detail,debug,info,warning,error,critical,passive}]
                [--log_on_each_node [LOG_ON_EACH_NODE]]
                [--no_log_on_each_node] [--logging_dir LOGGING_DIR]
                [--logging_strategy {no,steps,epoch}]
                [--logging_first_step [LOGGING_FIRST_STEP]]
                [--logging_steps LOGGING_STEPS]
                [--logging_nan_inf_filter [LOGGING_NAN_INF_FILTER]]
                [--no_logging_nan_inf_filter]
                [--save_strategy {no,steps,epoch}] [--save_steps SAVE_STEPS]
                [--save_total_limit SAVE_TOTAL_LIMIT]
                [--save_safetensors [SAVE_SAFETENSORS]]
                [--no_save_safetensors]
                [--save_on_each_node [SAVE_ON_EACH_NODE]]
                [--save_only_model [SAVE_ONLY_MODEL]]
                [--restore_callback_states_from_checkpoint [RESTORE_CALLBACK_STATES_FROM_CHECKPOINT]]
                [--no_cuda [NO_CUDA]] [--use_cpu [USE_CPU]]
                [--use_mps_device [USE_MPS_DEVICE]] [--seed SEED]
                [--data_seed DATA_SEED] [--jit_mode_eval [JIT_MODE_EVAL]]
                [--use_ipex [USE_IPEX]] [--bf16 [BF16]] [--fp16 [FP16]]
                [--fp16_opt_level FP16_OPT_LEVEL]
                [--half_precision_backend {auto,apex,cpu_amp}]
                [--bf16_full_eval [BF16_FULL_EVAL]]
                [--fp16_full_eval [FP16_FULL_EVAL]] [--tf32 TF32]
                [--local_rank LOCAL_RANK]
                [--ddp_backend {nccl,gloo,mpi,ccl,hccl,cncl}]
                [--tpu_num_cores TPU_NUM_CORES]
                [--tpu_metrics_debug [TPU_METRICS_DEBUG]]
                [--debug DEBUG [DEBUG ...]]
                [--dataloader_drop_last [DATALOADER_DROP_LAST]]
                [--eval_steps EVAL_STEPS]
                [--dataloader_num_workers DATALOADER_NUM_WORKERS]
                [--dataloader_prefetch_factor DATALOADER_PREFETCH_FACTOR]
                [--past_index PAST_INDEX] [--run_name RUN_NAME]
                [--disable_tqdm DISABLE_TQDM]
                [--remove_unused_columns [REMOVE_UNUSED_COLUMNS]]
                [--label_names LABEL_NAMES [LABEL_NAMES ...]]
                [--load_best_model_at_end [LOAD_BEST_MODEL_AT_END]]
                [--metric_for_best_model METRIC_FOR_BEST_MODEL]
                [--greater_is_better GREATER_IS_BETTER]
                [--ignore_data_skip [IGNORE_DATA_SKIP]] [--fsdp FSDP]
                [--fsdp_min_num_params FSDP_MIN_NUM_PARAMS]
                [--fsdp_config FSDP_CONFIG]
                [--fsdp_transformer_layer_cls_to_wrap FSDP_TRANSFORMER_LAYER_CLS_TO_WRAP]
                [--accelerator_config ACCELERATOR_CONFIG]
                [--deepspeed DEEPSPEED]
                [--label_smoothing_factor LABEL_SMOOTHING_FACTOR]
                [--optim OPTIM] [--optim_args OPTIM_ARGS]
                [--adafactor [ADAFACTOR]]
                [--group_by_length [GROUP_BY_LENGTH]]
                [--length_column_name LENGTH_COLUMN_NAME]
                [--report_to REPORT_TO]
                [--ddp_find_unused_parameters DDP_FIND_UNUSED_PARAMETERS]
                [--ddp_bucket_cap_mb DDP_BUCKET_CAP_MB]
                [--ddp_broadcast_buffers DDP_BROADCAST_BUFFERS]
                [--dataloader_pin_memory [DATALOADER_PIN_MEMORY]]
                [--no_dataloader_pin_memory]
                [--dataloader_persistent_workers [DATALOADER_PERSISTENT_WORKERS]]
                [--skip_memory_metrics [SKIP_MEMORY_METRICS]]
                [--no_skip_memory_metrics]
                [--use_legacy_prediction_loop [USE_LEGACY_PREDICTION_LOOP]]
                [--push_to_hub [PUSH_TO_HUB]]
                [--resume_from_checkpoint RESUME_FROM_CHECKPOINT]
                [--hub_model_id HUB_MODEL_ID]
                [--hub_strategy {end,every_save,checkpoint,all_checkpoints}]
                [--hub_token HUB_TOKEN]
                [--hub_private_repo [HUB_PRIVATE_REPO]]
                [--hub_always_push [HUB_ALWAYS_PUSH]]
                [--gradient_checkpointing [GRADIENT_CHECKPOINTING]]
                [--gradient_checkpointing_kwargs GRADIENT_CHECKPOINTING_KWARGS]
                [--include_inputs_for_metrics [INCLUDE_INPUTS_FOR_METRICS]]
                [--eval_do_concat_batches [EVAL_DO_CONCAT_BATCHES]]
                [--no_eval_do_concat_batches]
                [--fp16_backend {auto,apex,cpu_amp}]
                [--evaluation_strategy {no,steps,epoch}]
                [--push_to_hub_model_id PUSH_TO_HUB_MODEL_ID]
                [--push_to_hub_organization PUSH_TO_HUB_ORGANIZATION]
                [--push_to_hub_token PUSH_TO_HUB_TOKEN]
                [--mp_parameters MP_PARAMETERS]
                [--auto_find_batch_size [AUTO_FIND_BATCH_SIZE]]
                [--full_determinism [FULL_DETERMINISM]]
                [--torchdynamo TORCHDYNAMO] [--ray_scope RAY_SCOPE]
                [--ddp_timeout DDP_TIMEOUT] [--torch_compile [TORCH_COMPILE]]
                [--torch_compile_backend TORCH_COMPILE_BACKEND]
                [--torch_compile_mode TORCH_COMPILE_MODE]
                [--dispatch_batches DISPATCH_BATCHES]
                [--split_batches SPLIT_BATCHES]
                [--include_tokens_per_second [INCLUDE_TOKENS_PER_SECOND]]
                [--include_num_input_tokens_seen [INCLUDE_NUM_INPUT_TOKENS_SEEN]]
                [--neftune_noise_alpha NEFTUNE_NOISE_ALPHA]
                [--optim_target_modules OPTIM_TARGET_MODULES]
                [--batch_eval_metrics [BATCH_EVAL_METRICS]]
                [--eval_on_start [EVAL_ON_START]]
                [--eval_use_gather_object [EVAL_USE_GATHER_OBJECT]]
                [--cache_dir CACHE_DIR]
                [--freeze_mm_mlp_adapter [FREEZE_MM_MLP_ADAPTER]]
                [--mpt_attn_impl MPT_ATTN_IMPL]
                [--model_max_length MODEL_MAX_LENGTH]
                [--double_quant [DOUBLE_QUANT]] [--no_double_quant]
                [--quant_type QUANT_TYPE] [--bits BITS]
                [--lora_enable [LORA_ENABLE]] [--lora_r LORA_R]
                [--lora_alpha LORA_ALPHA] [--lora_dropout LORA_DROPOUT]
                [--lora_weight_path LORA_WEIGHT_PATH] [--lora_bias LORA_BIAS]
                [--mm_projector_lr MM_PROJECTOR_LR]
                [--mm_inv_projector_lr MM_INV_PROJECTOR_LR]
                [--mm_vision_tower_lr MM_VISION_TOWER_LR]
                [--group_by_modality_length [GROUP_BY_MODALITY_LENGTH]]
train.py: error: argument --run_name: expected one argument
train.py: error: argument --run_name: expected one argument
usage: train.py [-h] [--model_name_or_path MODEL_NAME_OR_PATH]
                [--version VERSION] [--freeze_backbone [FREEZE_BACKBONE]]
                [--tune_mm_mlp_adapter [TUNE_MM_MLP_ADAPTER]]
                [--vision_tower VISION_TOWER]
                [--unfreeze_mm_vision_tower [UNFREEZE_MM_VISION_TOWER]]
                [--mm_pixel_decoder MM_PIXEL_DECODER]
                [--mm_vision_select_layer MM_VISION_SELECT_LAYER]
                [--pretrain_mm_mlp_adapter PRETRAIN_MM_MLP_ADAPTER]
                [--pretrain_mm_inv_mlp_adapter PRETRAIN_MM_INV_MLP_ADAPTER]
                [--mm_projector_type MM_PROJECTOR_TYPE]
                [--mm_inv_projector_type MM_INV_PROJECTOR_TYPE]
                [--mm_use_im_start_end [MM_USE_IM_START_END]]
                [--mm_use_im_patch_token [MM_USE_IM_PATCH_TOKEN]]
                [--no_mm_use_im_patch_token]
                [--mm_patch_merge_type MM_PATCH_MERGE_TYPE]
                [--mm_vision_select_feature MM_VISION_SELECT_FEATURE]
                [--data_path DATA_PATH] [--lazy_preprocess [LAZY_PREPROCESS]]
                [--is_multimodal [IS_MULTIMODAL]]
                [--image_folder IMAGE_FOLDER]
                [--image_aspect_ratio IMAGE_ASPECT_RATIO] --output_dir
                OUTPUT_DIR [--overwrite_output_dir [OVERWRITE_OUTPUT_DIR]]
                [--do_train [DO_TRAIN]] [--do_eval [DO_EVAL]]
                [--do_predict [DO_PREDICT]] [--eval_strategy {no,steps,epoch}]
                [--prediction_loss_only [PREDICTION_LOSS_ONLY]]
                [--per_device_train_batch_size PER_DEVICE_TRAIN_BATCH_SIZE]
                [--per_device_eval_batch_size PER_DEVICE_EVAL_BATCH_SIZE]
                [--per_gpu_train_batch_size PER_GPU_TRAIN_BATCH_SIZE]
                [--per_gpu_eval_batch_size PER_GPU_EVAL_BATCH_SIZE]
                [--gradient_accumulation_steps GRADIENT_ACCUMULATION_STEPS]
                [--eval_accumulation_steps EVAL_ACCUMULATION_STEPS]
                [--eval_delay EVAL_DELAY]
                [--torch_empty_cache_steps TORCH_EMPTY_CACHE_STEPS]
                [--learning_rate LEARNING_RATE] [--weight_decay WEIGHT_DECAY]
                [--adam_beta1 ADAM_BETA1] [--adam_beta2 ADAM_BETA2]
                [--adam_epsilon ADAM_EPSILON] [--max_grad_norm MAX_GRAD_NORM]
                [--num_train_epochs NUM_TRAIN_EPOCHS] [--max_steps MAX_STEPS]
                [--lr_scheduler_type {linear,cosine,cosine_with_restarts,polynomial,constant,constant_with_warmup,inverse_sqrt,reduce_lr_on_plateau,cosine_with_min_lr,warmup_stable_decay}]
                [--lr_scheduler_kwargs LR_SCHEDULER_KWARGS]
                [--warmup_ratio WARMUP_RATIO] [--warmup_steps WARMUP_STEPS]
                [--log_level {detail,debug,info,warning,error,critical,passive}]
                [--log_level_replica {detail,debug,info,warning,error,critical,passive}]
                [--log_on_each_node [LOG_ON_EACH_NODE]]
                [--no_log_on_each_node] [--logging_dir LOGGING_DIR]
                [--logging_strategy {no,steps,epoch}]
                [--logging_first_step [LOGGING_FIRST_STEP]]
                [--logging_steps LOGGING_STEPS]
                [--logging_nan_inf_filter [LOGGING_NAN_INF_FILTER]]
                [--no_logging_nan_inf_filter]
                [--save_strategy {no,steps,epoch}] [--save_steps SAVE_STEPS]
                [--save_total_limit SAVE_TOTAL_LIMIT]
                [--save_safetensors [SAVE_SAFETENSORS]]
                [--no_save_safetensors]
                [--save_on_each_node [SAVE_ON_EACH_NODE]]
                [--save_only_model [SAVE_ONLY_MODEL]]
                [--restore_callback_states_from_checkpoint [RESTORE_CALLBACK_STATES_FROM_CHECKPOINT]]
                [--no_cuda [NO_CUDA]] [--use_cpu [USE_CPU]]
                [--use_mps_device [USE_MPS_DEVICE]] [--seed SEED]
                [--data_seed DATA_SEED] [--jit_mode_eval [JIT_MODE_EVAL]]
                [--use_ipex [USE_IPEX]] [--bf16 [BF16]] [--fp16 [FP16]]
                [--fp16_opt_level FP16_OPT_LEVEL]
                [--half_precision_backend {auto,apex,cpu_amp}]
                [--bf16_full_eval [BF16_FULL_EVAL]]
                [--fp16_full_eval [FP16_FULL_EVAL]] [--tf32 TF32]
                [--local_rank LOCAL_RANK]
                [--ddp_backend {nccl,gloo,mpi,ccl,hccl,cncl}]
                [--tpu_num_cores TPU_NUM_CORES]
                [--tpu_metrics_debug [TPU_METRICS_DEBUG]]
                [--debug DEBUG [DEBUG ...]]
                [--dataloader_drop_last [DATALOADER_DROP_LAST]]
                [--eval_steps EVAL_STEPS]
                [--dataloader_num_workers DATALOADER_NUM_WORKERS]
                [--dataloader_prefetch_factor DATALOADER_PREFETCH_FACTOR]
                [--past_index PAST_INDEX] [--run_name RUN_NAME]
                [--disable_tqdm DISABLE_TQDM]
                [--remove_unused_columns [REMOVE_UNUSED_COLUMNS]]
                [--label_names LABEL_NAMES [LABEL_NAMES ...]]
                [--load_best_model_at_end [LOAD_BEST_MODEL_AT_END]]
                [--metric_for_best_model METRIC_FOR_BEST_MODEL]
                [--greater_is_better GREATER_IS_BETTER]
                [--ignore_data_skip [IGNORE_DATA_SKIP]] [--fsdp FSDP]
                [--fsdp_min_num_params FSDP_MIN_NUM_PARAMS]
                [--fsdp_config FSDP_CONFIG]
                [--fsdp_transformer_layer_cls_to_wrap FSDP_TRANSFORMER_LAYER_CLS_TO_WRAP]
                [--accelerator_config ACCELERATOR_CONFIG]
                [--deepspeed DEEPSPEED]
                [--label_smoothing_factor LABEL_SMOOTHING_FACTOR]
                [--optim OPTIM] [--optim_args OPTIM_ARGS]
                [--adafactor [ADAFACTOR]]
                [--group_by_length [GROUP_BY_LENGTH]]
                [--length_column_name LENGTH_COLUMN_NAME]
                [--report_to REPORT_TO]
                [--ddp_find_unused_parameters DDP_FIND_UNUSED_PARAMETERS]
                [--ddp_bucket_cap_mb DDP_BUCKET_CAP_MB]
                [--ddp_broadcast_buffers DDP_BROADCAST_BUFFERS]
                [--dataloader_pin_memory [DATALOADER_PIN_MEMORY]]
                [--no_dataloader_pin_memory]
                [--dataloader_persistent_workers [DATALOADER_PERSISTENT_WORKERS]]
                [--skip_memory_metrics [SKIP_MEMORY_METRICS]]
                [--no_skip_memory_metrics]
                [--use_legacy_prediction_loop [USE_LEGACY_PREDICTION_LOOP]]
                [--push_to_hub [PUSH_TO_HUB]]
                [--resume_from_checkpoint RESUME_FROM_CHECKPOINT]
                [--hub_model_id HUB_MODEL_ID]
                [--hub_strategy {end,every_save,checkpoint,all_checkpoints}]
                [--hub_token HUB_TOKEN]
                [--hub_private_repo [HUB_PRIVATE_REPO]]
                [--hub_always_push [HUB_ALWAYS_PUSH]]
                [--gradient_checkpointing [GRADIENT_CHECKPOINTING]]
                [--gradient_checkpointing_kwargs GRADIENT_CHECKPOINTING_KWARGS]
                [--include_inputs_for_metrics [INCLUDE_INPUTS_FOR_METRICS]]
                [--eval_do_concat_batches [EVAL_DO_CONCAT_BATCHES]]
                [--no_eval_do_concat_batches]
                [--fp16_backend {auto,apex,cpu_amp}]
                [--evaluation_strategy {no,steps,epoch}]
                [--push_to_hub_model_id PUSH_TO_HUB_MODEL_ID]
                [--push_to_hub_organization PUSH_TO_HUB_ORGANIZATION]
                [--push_to_hub_token PUSH_TO_HUB_TOKEN]
                [--mp_parameters MP_PARAMETERS]
                [--auto_find_batch_size [AUTO_FIND_BATCH_SIZE]]
                [--full_determinism [FULL_DETERMINISM]]
                [--torchdynamo TORCHDYNAMO] [--ray_scope RAY_SCOPE]
                [--ddp_timeout DDP_TIMEOUT] [--torch_compile [TORCH_COMPILE]]
                [--torch_compile_backend TORCH_COMPILE_BACKEND]
                [--torch_compile_mode TORCH_COMPILE_MODE]
                [--dispatch_batches DISPATCH_BATCHES]
                [--split_batches SPLIT_BATCHES]
                [--include_tokens_per_second [INCLUDE_TOKENS_PER_SECOND]]
                [--include_num_input_tokens_seen [INCLUDE_NUM_INPUT_TOKENS_SEEN]]
                [--neftune_noise_alpha NEFTUNE_NOISE_ALPHA]
                [--optim_target_modules OPTIM_TARGET_MODULES]
                [--batch_eval_metrics [BATCH_EVAL_METRICS]]
                [--eval_on_start [EVAL_ON_START]]
                [--eval_use_gather_object [EVAL_USE_GATHER_OBJECT]]
                [--cache_dir CACHE_DIR]
                [--freeze_mm_mlp_adapter [FREEZE_MM_MLP_ADAPTER]]
                [--mpt_attn_impl MPT_ATTN_IMPL]
                [--model_max_length MODEL_MAX_LENGTH]
                [--double_quant [DOUBLE_QUANT]] [--no_double_quant]
                [--quant_type QUANT_TYPE] [--bits BITS]
                [--lora_enable [LORA_ENABLE]] [--lora_r LORA_R]
                [--lora_alpha LORA_ALPHA] [--lora_dropout LORA_DROPOUT]
                [--lora_weight_path LORA_WEIGHT_PATH] [--lora_bias LORA_BIAS]
                [--mm_projector_lr MM_PROJECTOR_LR]
                [--mm_inv_projector_lr MM_INV_PROJECTOR_LR]
                [--mm_vision_tower_lr MM_VISION_TOWER_LR]
                [--group_by_modality_length [GROUP_BY_MODALITY_LENGTH]]
train.py: error: argument --run_name: expected one argument
usage: train.py [-h] [--model_name_or_path MODEL_NAME_OR_PATH]
                [--version VERSION] [--freeze_backbone [FREEZE_BACKBONE]]
                [--tune_mm_mlp_adapter [TUNE_MM_MLP_ADAPTER]]
                [--vision_tower VISION_TOWER]
                [--unfreeze_mm_vision_tower [UNFREEZE_MM_VISION_TOWER]]
                [--mm_pixel_decoder MM_PIXEL_DECODER]
                [--mm_vision_select_layer MM_VISION_SELECT_LAYER]
                [--pretrain_mm_mlp_adapter PRETRAIN_MM_MLP_ADAPTER]
                [--pretrain_mm_inv_mlp_adapter PRETRAIN_MM_INV_MLP_ADAPTER]
                [--mm_projector_type MM_PROJECTOR_TYPE]
                [--mm_inv_projector_type MM_INV_PROJECTOR_TYPE]
                [--mm_use_im_start_end [MM_USE_IM_START_END]]
                [--mm_use_im_patch_token [MM_USE_IM_PATCH_TOKEN]]
                [--no_mm_use_im_patch_token]
                [--mm_patch_merge_type MM_PATCH_MERGE_TYPE]
                [--mm_vision_select_feature MM_VISION_SELECT_FEATURE]
                [--data_path DATA_PATH] [--lazy_preprocess [LAZY_PREPROCESS]]
                [--is_multimodal [IS_MULTIMODAL]]
                [--image_folder IMAGE_FOLDER]
                [--image_aspect_ratio IMAGE_ASPECT_RATIO] --output_dir
                OUTPUT_DIR [--overwrite_output_dir [OVERWRITE_OUTPUT_DIR]]
                [--do_train [DO_TRAIN]] [--do_eval [DO_EVAL]]
                [--do_predict [DO_PREDICT]] [--eval_strategy {no,steps,epoch}]
                [--prediction_loss_only [PREDICTION_LOSS_ONLY]]
                [--per_device_train_batch_size PER_DEVICE_TRAIN_BATCH_SIZE]
                [--per_device_eval_batch_size PER_DEVICE_EVAL_BATCH_SIZE]
                [--per_gpu_train_batch_size PER_GPU_TRAIN_BATCH_SIZE]
                [--per_gpu_eval_batch_size PER_GPU_EVAL_BATCH_SIZE]
                [--gradient_accumulation_steps GRADIENT_ACCUMULATION_STEPS]
                [--eval_accumulation_steps EVAL_ACCUMULATION_STEPS]
                [--eval_delay EVAL_DELAY]
                [--torch_empty_cache_steps TORCH_EMPTY_CACHE_STEPS]
                [--learning_rate LEARNING_RATE] [--weight_decay WEIGHT_DECAY]
                [--adam_beta1 ADAM_BETA1] [--adam_beta2 ADAM_BETA2]
                [--adam_epsilon ADAM_EPSILON] [--max_grad_norm MAX_GRAD_NORM]
                [--num_train_epochs NUM_TRAIN_EPOCHS] [--max_steps MAX_STEPS]
                [--lr_scheduler_type {linear,cosine,cosine_with_restarts,polynomial,constant,constant_with_warmup,inverse_sqrt,reduce_lr_on_plateau,cosine_with_min_lr,warmup_stable_decay}]
                [--lr_scheduler_kwargs LR_SCHEDULER_KWARGS]
                [--warmup_ratio WARMUP_RATIO] [--warmup_steps WARMUP_STEPS]
                [--log_level {detail,debug,info,warning,error,critical,passive}]
                [--log_level_replica {detail,debug,info,warning,error,critical,passive}]
                [--log_on_each_node [LOG_ON_EACH_NODE]]
                [--no_log_on_each_node] [--logging_dir LOGGING_DIR]
                [--logging_strategy {no,steps,epoch}]
                [--logging_first_step [LOGGING_FIRST_STEP]]
                [--logging_steps LOGGING_STEPS]
                [--logging_nan_inf_filter [LOGGING_NAN_INF_FILTER]]
                [--no_logging_nan_inf_filter]
                [--save_strategy {no,steps,epoch}] [--save_steps SAVE_STEPS]
                [--save_total_limit SAVE_TOTAL_LIMIT]
                [--save_safetensors [SAVE_SAFETENSORS]]
                [--no_save_safetensors]
                [--save_on_each_node [SAVE_ON_EACH_NODE]]
                [--save_only_model [SAVE_ONLY_MODEL]]
                [--restore_callback_states_from_checkpoint [RESTORE_CALLBACK_STATES_FROM_CHECKPOINT]]
                [--no_cuda [NO_CUDA]] [--use_cpu [USE_CPU]]
                [--use_mps_device [USE_MPS_DEVICE]] [--seed SEED]
                [--data_seed DATA_SEED] [--jit_mode_eval [JIT_MODE_EVAL]]
                [--use_ipex [USE_IPEX]] [--bf16 [BF16]] [--fp16 [FP16]]
                [--fp16_opt_level FP16_OPT_LEVEL]
                [--half_precision_backend {auto,apex,cpu_amp}]
                [--bf16_full_eval [BF16_FULL_EVAL]]
                [--fp16_full_eval [FP16_FULL_EVAL]] [--tf32 TF32]
                [--local_rank LOCAL_RANK]
                [--ddp_backend {nccl,gloo,mpi,ccl,hccl,cncl}]
                [--tpu_num_cores TPU_NUM_CORES]
                [--tpu_metrics_debug [TPU_METRICS_DEBUG]]
                [--debug DEBUG [DEBUG ...]]
                [--dataloader_drop_last [DATALOADER_DROP_LAST]]
                [--eval_steps EVAL_STEPS]
                [--dataloader_num_workers DATALOADER_NUM_WORKERS]
                [--dataloader_prefetch_factor DATALOADER_PREFETCH_FACTOR]
                [--past_index PAST_INDEX] [--run_name RUN_NAME]
                [--disable_tqdm DISABLE_TQDM]
                [--remove_unused_columns [REMOVE_UNUSED_COLUMNS]]
                [--label_names LABEL_NAMES [LABEL_NAMES ...]]
                [--load_best_model_at_end [LOAD_BEST_MODEL_AT_END]]
                [--metric_for_best_model METRIC_FOR_BEST_MODEL]
                [--greater_is_better GREATER_IS_BETTER]
                [--ignore_data_skip [IGNORE_DATA_SKIP]] [--fsdp FSDP]
                [--fsdp_min_num_params FSDP_MIN_NUM_PARAMS]
                [--fsdp_config FSDP_CONFIG]
                [--fsdp_transformer_layer_cls_to_wrap FSDP_TRANSFORMER_LAYER_CLS_TO_WRAP]
                [--accelerator_config ACCELERATOR_CONFIG]
                [--deepspeed DEEPSPEED]
                [--label_smoothing_factor LABEL_SMOOTHING_FACTOR]
                [--optim OPTIM] [--optim_args OPTIM_ARGS]
                [--adafactor [ADAFACTOR]]
                [--group_by_length [GROUP_BY_LENGTH]]
                [--length_column_name LENGTH_COLUMN_NAME]
                [--report_to REPORT_TO]
                [--ddp_find_unused_parameters DDP_FIND_UNUSED_PARAMETERS]
                [--ddp_bucket_cap_mb DDP_BUCKET_CAP_MB]
                [--ddp_broadcast_buffers DDP_BROADCAST_BUFFERS]
                [--dataloader_pin_memory [DATALOADER_PIN_MEMORY]]
                [--no_dataloader_pin_memory]
                [--dataloader_persistent_workers [DATALOADER_PERSISTENT_WORKERS]]
                [--skip_memory_metrics [SKIP_MEMORY_METRICS]]
                [--no_skip_memory_metrics]
                [--use_legacy_prediction_loop [USE_LEGACY_PREDICTION_LOOP]]
                [--push_to_hub [PUSH_TO_HUB]]
                [--resume_from_checkpoint RESUME_FROM_CHECKPOINT]
                [--hub_model_id HUB_MODEL_ID]
                [--hub_strategy {end,every_save,checkpoint,all_checkpoints}]
                [--hub_token HUB_TOKEN]
                [--hub_private_repo [HUB_PRIVATE_REPO]]
                [--hub_always_push [HUB_ALWAYS_PUSH]]
                [--gradient_checkpointing [GRADIENT_CHECKPOINTING]]
                [--gradient_checkpointing_kwargs GRADIENT_CHECKPOINTING_KWARGS]
                [--include_inputs_for_metrics [INCLUDE_INPUTS_FOR_METRICS]]
                [--eval_do_concat_batches [EVAL_DO_CONCAT_BATCHES]]
                [--no_eval_do_concat_batches]
                [--fp16_backend {auto,apex,cpu_amp}]
                [--evaluation_strategy {no,steps,epoch}]
                [--push_to_hub_model_id PUSH_TO_HUB_MODEL_ID]
                [--push_to_hub_organization PUSH_TO_HUB_ORGANIZATION]
                [--push_to_hub_token PUSH_TO_HUB_TOKEN]
                [--mp_parameters MP_PARAMETERS]
                [--auto_find_batch_size [AUTO_FIND_BATCH_SIZE]]
                [--full_determinism [FULL_DETERMINISM]]
                [--torchdynamo TORCHDYNAMO] [--ray_scope RAY_SCOPE]
                [--ddp_timeout DDP_TIMEOUT] [--torch_compile [TORCH_COMPILE]]
                [--torch_compile_backend TORCH_COMPILE_BACKEND]
                [--torch_compile_mode TORCH_COMPILE_MODE]
                [--dispatch_batches DISPATCH_BATCHES]
                [--split_batches SPLIT_BATCHES]
                [--include_tokens_per_second [INCLUDE_TOKENS_PER_SECOND]]
                [--include_num_input_tokens_seen [INCLUDE_NUM_INPUT_TOKENS_SEEN]]
                [--neftune_noise_alpha NEFTUNE_NOISE_ALPHA]
                [--optim_target_modules OPTIM_TARGET_MODULES]
                [--batch_eval_metrics [BATCH_EVAL_METRICS]]
                [--eval_on_start [EVAL_ON_START]]
                [--eval_use_gather_object [EVAL_USE_GATHER_OBJECT]]
                [--cache_dir CACHE_DIR]
                [--freeze_mm_mlp_adapter [FREEZE_MM_MLP_ADAPTER]]
                [--mpt_attn_impl MPT_ATTN_IMPL]
                [--model_max_length MODEL_MAX_LENGTH]
                [--double_quant [DOUBLE_QUANT]] [--no_double_quant]
                [--quant_type QUANT_TYPE] [--bits BITS]
                [--lora_enable [LORA_ENABLE]] [--lora_r LORA_R]
                [--lora_alpha LORA_ALPHA] [--lora_dropout LORA_DROPOUT]
                [--lora_weight_path LORA_WEIGHT_PATH] [--lora_bias LORA_BIAS]
                [--mm_projector_lr MM_PROJECTOR_LR]
                [--mm_inv_projector_lr MM_INV_PROJECTOR_LR]
                [--mm_vision_tower_lr MM_VISION_TOWER_LR]
                [--group_by_modality_length [GROUP_BY_MODALITY_LENGTH]]
train.py: error: argument --run_name: expected one argument
[2025-03-01 00:28:33,430] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 2) local_rank: 0 (pid: 1798951) of binary: /net/scratch2/hanyim/envs/ross/bin/python
Traceback (most recent call last):
  File "/net/scratch2/hanyim/envs/ross/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/net/scratch2/hanyim/envs/ross/lib/python3.10/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 346, in wrapper
    return f(*args, **kwargs)
  File "/net/scratch2/hanyim/envs/ross/lib/python3.10/site-packages/torch/distributed/run.py", line 806, in main
    run(args)
  File "/net/scratch2/hanyim/envs/ross/lib/python3.10/site-packages/torch/distributed/run.py", line 797, in run
    elastic_launch(
  File "/net/scratch2/hanyim/envs/ross/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 134, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/net/scratch2/hanyim/envs/ross/lib/python3.10/site-packages/torch/distributed/launcher/api.py", line 264, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
train.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2025-03-01_00:28:33
  host      : h001
  rank      : 1 (local_rank: 1)
  exitcode  : 2 (pid: 1798952)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2025-03-01_00:28:33
  host      : h001
  rank      : 2 (local_rank: 2)
  exitcode  : 2 (pid: 1798953)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2025-03-01_00:28:33
  host      : h001
  rank      : 3 (local_rank: 3)
  exitcode  : 2 (pid: 1798954)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2025-03-01_00:28:33
  host      : h001
  rank      : 0 (local_rank: 0)
  exitcode  : 2 (pid: 1798951)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
